version: 1
backend:
  phases:
    preBuild:
      commands:
        - git config advice.detachedHead false
        - git fetch --unshallow
        - git checkout main
        - echo "Installing SAM CLI..."
        - npm install -g aws-sam-cli
        - echo "Installing Node.js dependencies..."
        - npm install
    build:
      commands:
        - echo "Building SAM backend..."
        - sam build
        - echo "Deploying SAM backend..."
        - sam deploy --no-confirm-changeset --no-fail-on-empty-changeset --stack-name amplify-backend-project-stack --capabilities CAPABILITY_NAMED_IAM
frontend:
  phases:
    preBuild:
      commands: []
    build:
      commands: []
artifacts:
  baseDirectory: /
  files:
    - '**/*'
cache:
  paths: []