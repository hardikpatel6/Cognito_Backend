version: 1
backend:
  phases:
    build:
      commands:
        - npm install -g aws-cdk # if using CDK
        - pip install aws-sam-cli # if using SAM
        - sam build
        - sam package --s3-bucket $S3_BUCKET --output-template-file packaged.yaml
        - sam deploy --template-file packaged.yaml --stack-name cognito-backend --capabilities CAPABILITY_IAM
artifacts:
  baseDirectory: .
  files:
    - packaged.yaml
